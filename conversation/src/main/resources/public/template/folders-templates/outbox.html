<h3 whereami></h3>
<nav class="contextual-buttons twelve cell">
	<div class="">
		<input type="text" name="searchField.words" ng-model="searchField.words"
			   ng-keyup="$event.keyCode == 13 ? search(searchField.words) : null" class="ten cell"
			   i18n-placeholder="search" required autofocus/>
		<button class="cell right-magnet" ng-click="template.open('main', 'mail-actions/write-mail')">
			<i class="add"></i><i18n>create</i18n>
		</button>
	</div>
</nav>
<article class="list list-view twelve cell mailbox">
	<table class="twelve">
		<thead>
		<tr>
			<th class="icon">
				<label class="checkbox cell"><input type="checkbox" ng-model="state.selectAll" ng-change="switchSelectAll()" />
					<i18n></i18n>
				</label>
			</th>
			<th class="unread"></th>
			<th class="content" ng-click="setSort(folders.outbox, sortBy.subject)"><i18n>to</i18n></th>
			<th class="icon"></th>
			<th class="date" ng-click="setSort(folders.outbox, sortBy.date)"><i18n>date</i18n></th>
		</tr>
		</thead>
		<tbody ng-if="isLoading()">
		<tr>
			<td>
				<h1 class="nomargin"><i18n>loading</i18n></h1>
			</td>
		</tr>
		</tbody>
		<tbody ng-if="!isLoading()">
		<tr ng-if="conversation.currentFolder.mails.empty()">
			<td colspan="4">
				<i18n>folder.empty</i18n>
			</td>
		</tr>
		<tr ng-repeat="mail in folders.outbox.mails.all | orderBy : folders.outbox.sort : folders.outbox.reverse"
		    ng-class="{ checked: mail.selected }" dragstart="drag(mail, $originalEvent)">
			<td>
				<div class="avatar">
					<i class="sticker app type messagerie" ng-if="mail.to.length != 1"></i>
					<img ng-if="mail.to.length == 1" ng-src="/userbook/avatar/{{ mail.to[0] }}?thumbnail=100x100"/>
					<label class="checkbox cell"><input type="checkbox" ng-model="mail.selected" />
						<i18n></i18n>
					</label>
				</div>
			</td>
			<td class="unread"></td>
			<td class="content"
				ng-init="recs = allReceivers(mail)"
				ng-click="viewMail(mail)">
					<div>
						<span class="medium-text">
							<span ng-repeat="receiver in receivers = (recs | limitTo:2 | filter: filterUsers(mail))">
								<a ng-if="!receiver.deleted && !users.list.isGroup(receiver)">[[mail.map(receiver).displayName]]</a><span ng-if="!receiver.deleted &&  users.list.isGroup(receiver)">[[mail.map(receiver).displayName]]</span><span ng-if="receiver.deleted">[[receiver.displayName]]</span><span ng-if="$index < 1 && receivers.length > 1">,</span>
							</span>
							<span ng-if="receivers.length > 2">...</span>
						</span>
					</div>
					[[mail.subject]]
			</td>
			<td class="attach"><i class="attachment" ng-if="mail.attachments.length"></i></td>
			<td class="date">[[mail.sentDate()]]</td>
		</tr>
		</tbody>
	</table>
</article>

<container template="toaster"></container>