<h3 whereami></h3>
<nav class="twelve cell">
	<div class="">
		<switch-search
			ng-model="searchField.words"
			ng-change="search(words)"
			cancel="cancelSearch()">
			<button class="cell cell-ellipsis right-magnet" ng-click="template.open('main', 'mail-actions/write-mail')">
				<i class="add"></i><i18n>new.message</i18n>
			</button>
		</switch-search>
	</div>
</nav>


<div class="mailbox-tools notification twelve flex-row align-center centered-text zero-mobile no-margin">
	<div class="check-col">
		<label class="wrapping-checkbox relative">
			<input type="checkbox" ng-model="state.selectAll" ng-change="switchSelectAll()" />
			<i18n></i18n>
		</label>
	</div>
	<div class="status-filter">
		<label class="chip">
			<i class="mail"></i>
			<span></span>
			<!-- mettre taille wrapper en dur -->

		</label>
	</div>
	<div class="flex-all-remains cell horizontal-margin">
		<!-- MLAP check si la recherche met bien Ã  jour les brouillons-->
		<div class="search-pagination">
			<input class="twelve" name="searchField.words" type="text" ng-model="searchField.words"
			ng-keyup="$event.keyCode == 13 ? search(searchField.words) : null"
			i18n-placeholder="search"/>
			<i class="search-2" ng-click="search(searchField.words)"></i>
		</div>
		<a><i ng-if="searchField.words.length > 0" class="close-2x horizontal-spacing" ng-click='searchField.words="";cancelSearch()'></i></a>
	</div>
</div>


<div class="mailbox">

	<div ng-if="isLoading()">
		<h1 class="nomargin"><i18n>loading</i18n></h1>
	</div>
	<div ng-if="folders.inbox.mails.all.length == 0">
		<i18n>folder.empty</i18n>
	</div>

	<div class="notification relative no-margin" ng-if="!isLoading()"
		ng-repeat="mail in folders.draft.mails.all | orderBy : folders.draft.sort : folders.draft.reverse"
		ng-class="{ checked: mail.selected}"
		dragstart="drag(mail, $originalEvent)">

		<article ng-click="editDraft(mail);$event.stopPropagation();">
			<div class="flex-row align-center">
				<label class="wrapping-checkbox">
					<div class="avatar" ng-click="$event.stopPropagation();">
						<!-- MLAP mettre condition si groupes ou no-user-->
						<img ng-src="/userbook/avatar/[[mail.from]]?thumbnail=100x100"/>
						<input type="checkbox" ng-model="mail.selected"/>
						<i18n></i18n>
					</div>
				</label>

				<div class="states"><!-- keep empty --></div>
				<div class="flex-all-remains horizontal-margin cell-ellipsis">
					<div class="strong" ng-repeat="receiver in receivers = (mail.to | limitTo:2 | filter: filterUsers(mail))">
						<span ng-if="!users.list.isGroup(receiver)">[[mail.map(receiver).displayName]]</span>
						<span ng-if="users.list.isGroup(receiver)">[[mail.map(receiver).displayName]]</span>
						<span ng-if="$index < 1 && receivers.length > 1">,</span>
					</div>
					<span class="strong" ng-if="receivers.length > 2">...</span>
					<br>
					<span class="small-text">[[mail.subject]]</span>
				</div>
			</div>

			<div class="notification-date">
				<em class="low-importance right-magnet">[[mail.sentDate()]]</em>
			</div>
			<div class="notification-attachment">
				<i class="attachment" ng-if="mail.attachments.length"></i>
			</div>

		</article>
	</div>
</div>

<container template="toaster"></container>
